---
title: "Programming in Base R"
format: html
editor: visual
---

# Task 1: Basic Vector practice

## 1. Create two vectors for the pre-treatment and post treatement measurements.

```{r}
PreTreatment <-c(130, 128, 116, 124, 133, 134, 118, 126, 114, 127, 141, 138, 128, 140, 137, 131, 120, 128, 139, 135)

AfterTreatment <-c(114, 98, 113, 99, 107, 116, 113, 111, 119, 117, 101, 119, 130, 122, 106, 106, 124, 102, 117, 113)

PreTreatment
AfterTreatment

```

## 2. Assign names to the vector elements.

```{r}
Subject <- paste("Subject", 1:20, sep = "_")
Subject

```

## 3. Calculate change in blood pressure between treatements.

```{r}
TreatmentDiffs <- (AfterTreatment-PreTreatment) 

TreatmentDiffs
```

## 4. Calculate the average decrease in blood pressure across all patients.

```{r}
mean(TreatmentDiffs)
```

## 5. Determine which patients experienced a decrease in blood pressure.

```{r}
Subject[which(AfterTreatment < PreTreatment)]
```

## 6. Subset the vector of differences to only return those that have a positive change

```{r}
TreatmentDiffs [which(AfterTreatment < PreTreatment)]
```

## 7. Calculate the average decrease in blood pressure.

```{r}
mean(TreatmentDiffs[which(AfterTreatment < PreTreatment)])
```

# Task 2

## 1. Create a data frame object with four columns corresponding to the above data.

```{r}
TreatmentsDF <- data.frame(Subject, PreTreatment, AfterTreatment, TreatmentDiffs)
TreatmentsDF
```

## 2. Return only rows where TreatmentDiffs column is negative.

```{r}
TreatmentsDF[which(TreatmentsDF$TreatmentDiffs < 0), ]
```

## 3. Add a new column to the data frame corresponding to TRUE if the AfterTreatment BP is less than 120.

```{r}
TreatmentsDF <- TreatmentsDF |>
  mutate(BPUnder120 = AfterTreatment < 120)
```

## 4. Print the data frame out nicely in the final documnet.

```{r}
knitr::kable(TreatmentsDF)
```

# Task 3

## 1. Create a new data frame with the placebo experiment.

```{r}
PlaceboDF <- data.frame(Subject = 
  PLSubject <- paste("Subject", 1:10, sep = "_"), 
  PlaceboBefore = PlaceboBefore <- c(138, 135, 147, 117, 152, 134, 114, 121, 131, 130), 
  PlaceboAfter = PlaceboAfter <- c(105, 136, 123, 130, 134, 143, 135, 139, 120, 124), 
  PlaceboDiffs = PlaceboDiffs <- (PlaceboAfter - PlaceboBefore) 
)
PlaceboDF <- PlaceboDF |> mutate(PLBPUnder120 = PlaceboAfter < 120)
PlaceboDF

```

## 2. Create and store a list with two elemenets. Treatement and Placebo

```{r}
BloodPressure <- list(TreatmentsDF, PlaceboDF)
```

## 3. Access the first list element using three different types of syntax

```{r}
BloodPressure[1]
BloodPressure[1:1]
BloodPressure[[1]]
```

## 4. In one line, access the placebo data frame, PlaceboBefore column

```{r}
BloodPressure[[2]][[2]]
```

# Task 4

## 1. Create a new "status" column in each data frame above

```{r}
BloodPressure[[1]]$Status <- character(20) 
BloodPressure[[2]]$Status <- character(10) 
```

## 2. Create a loop using if/than/else logic to create the status column's values.

```{r}
 for (i in seq_along(BloodPressure[[1]][[6]])){
if (BloodPressure[[1]]$AfterTreatment[i] <= 120) {
  BloodPressure[[1]]$Status[i] <- "Optimal"
} else if (BloodPressure[[1]]$AfterTreatment[i] <= 130) {
  BloodPressure[[1]]$Status[i] <- "Borderline"
} else if (BloodPressure[[1]]$AfterTreatment[i] > 130) {
  BloodPressure[[1]]$Status[i] <-"High"
} else {
  BloodPressure[[1]]$Status[i] <-"Error"
}
}
```

## 3. Repeat "3." for the placebo data frame (within the list).

```{r}
 for (i in seq_along(BloodPressure[[2]][[6]])){
if (BloodPressure[[2]]$PlaceboAfter[i] <= 120) {
  BloodPressure[[2]]$Status[i] <- "Optimal"
} else if (BloodPressure[[2]]$PlaceboAfter[i] <= 130) {
  BloodPressure[[2]]$Status[i] <- "Borderline"
} else if (BloodPressure[[2]]$PlaceboAfter[i] > 130) {
  BloodPressure[[2]]$Status[i] <-"High"
} else {
  BloodPressure[[2]]$Status[i] <-"Error"
}
}
```

# Task 5
## 1. Write a function that
### -Takes in a list with two data frames in it
### - Takes in and R function with the default value beng set to "mean"
### - Finds the statistic of interest for the pre, post, and diff columns of both data frames
### - 